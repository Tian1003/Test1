<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data From JSON</title>

</head>

<body>
    <h3>臺南景點</h3>
    <hr>
    <div id="data-root">
        <div>wertyu</div>
    </div>
    <h3> start get data</h3>
    <script>

        // 1.設一個變數把API的URL存起來
        // var dataUrl = "https://www.twtainan.net/data/attractions_en.json";
        const resUrl = "https://soa.tainan.gov.tw/Api/Service/Get/bc2af2ac-4734-4171-bf6d-bf8722b5ef0d"
        // 2.new一個XMLHttpRequest物件(以此物件的方法進行資料請求) 
        var xhr = new XMLHttpRequest()

        // 3.以GET方法開啟一個請求
        //open('Method',API的URL,預設值為true非同步進行)
        xhr.open('GET', resUrl, true)

        // 4.送出請求(若為GET參數不填或填null)
        xhr.send()

        // 5-1 或直接用 onload => 資料接收/送出成功後執行的function
        xhr.onload = function () {
            var data = JSON.parse(xhr.responseText);
            console.log(data.data);

            const dataRoot = document.getElementById("data-root")
            //掃描每一筆資料
            data.data.forEach(element => {
                
                const newElement = document.createElement("div");
                newElement.innerHTML = JSON.stringify(element);
                dataRoot.appendChild(newElement);
            });
            // console.log(dataRoot)
        }
    </script>
    <h3>end</h3>
</body>

</html>